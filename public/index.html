Index Â· HTML
Copy

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>âš¡ Office Quiz Showdown</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet" />
<script src="/socket.io/socket.io.js"></script>
<style>
  /* â”€â”€ Reset & Variables â”€â”€ */
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --a: #FF4D6D;
    --b: #4CC9F0;
    --bg: #0A0A12;
    --surface: #12121E;
    --surface2: #1A1A2E;
    --border: #2A2A40;
    --text: #E8E8F0;
    --muted: #666680;
    --gold: #FFD700;
    --green: #06D6A0;
    --font-display: 'Bebas Neue', sans-serif;
    --font-body: 'DM Sans', sans-serif;
    --radius: 14px;
    --shadow: 0 8px 32px rgba(0,0,0,0.5);
  }

  body {
    font-family: var(--font-body);
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* â”€â”€ Animated BG â”€â”€ */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background:
      radial-gradient(ellipse 60% 40% at 20% 10%, rgba(255,77,109,0.08) 0%, transparent 60%),
      radial-gradient(ellipse 50% 60% at 80% 80%, rgba(76,201,240,0.07) 0%, transparent 60%);
    pointer-events: none;
    z-index: 0;
  }

  /* â”€â”€ Layout â”€â”€ */
  #app { position: relative; z-index: 1; min-height: 100vh; }

  .screen { display: none; }
  .screen.active { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; padding: 24px; }

  /* â”€â”€ Typography â”€â”€ */
  .display { font-family: var(--font-display); letter-spacing: 0.02em; }

  /* â”€â”€ Cards â”€â”€ */
  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 24px;
  }

  /* â”€â”€ Buttons â”€â”€ */
  .btn {
    font-family: var(--font-body);
    font-weight: 700;
    font-size: 15px;
    padding: 12px 28px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: transform 0.15s, box-shadow 0.15s, opacity 0.15s;
    letter-spacing: 0.03em;
  }
  .btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0,0,0,0.4); }
  .btn:active { transform: translateY(0); }
  .btn:disabled { opacity: 0.4; cursor: not-allowed; transform: none; }

  .btn-primary { background: linear-gradient(135deg, #FF4D6D, #FF1744); color: #fff; }
  .btn-a { background: linear-gradient(135deg, var(--a), #C9184A); color: #fff; }
  .btn-b { background: linear-gradient(135deg, var(--b), #0096C7); color: #fff; }
  .btn-ghost { background: transparent; color: var(--text); border: 1px solid var(--border); }
  .btn-green { background: linear-gradient(135deg, var(--green), #00B4D8); color: #000; }

  /* â”€â”€ Input â”€â”€ */
  .input {
    background: var(--surface2);
    border: 1.5px solid var(--border);
    border-radius: 8px;
    padding: 12px 16px;
    color: var(--text);
    font-family: var(--font-body);
    font-size: 15px;
    outline: none;
    transition: border-color 0.2s;
    width: 100%;
  }
  .input:focus { border-color: var(--a); }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     JOIN SCREEN
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  #joinScreen {
    background: none;
  }

  .join-box {
    width: 100%;
    max-width: 440px;
    text-align: center;
  }

  .logo-area {
    margin-bottom: 40px;
  }

  .logo-title {
    font-family: var(--font-display);
    font-size: clamp(52px, 10vw, 80px);
    line-height: 1;
    background: linear-gradient(135deg, var(--a) 0%, #FF8FA3 40%, var(--b) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .logo-sub {
    font-size: 13px;
    letter-spacing: 0.25em;
    text-transform: uppercase;
    color: var(--muted);
    margin-top: 8px;
  }

  .join-form { display: flex; flex-direction: column; gap: 14px; }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     LOBBY SCREEN
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  #lobbyScreen {
    justify-content: flex-start;
    padding: 0;
    max-width: 100%;
    width: 100%;
  }

  .lobby-layout {
    display: grid;
    grid-template-columns: 1fr 320px;
    grid-template-rows: auto 1fr;
    gap: 0;
    width: 100%;
    height: 100vh;
    max-width: 1200px;
    margin: 0 auto;
    padding: 24px;
    box-sizing: border-box;
  }

  .lobby-header {
    grid-column: 1 / -1;
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 20px;
  }

  .teams-area {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
    align-content: start;
  }

  .team-card {
    border-radius: var(--radius);
    padding: 20px;
    border: 2px solid transparent;
    transition: border-color 0.2s, transform 0.2s;
  }

  .team-card.team-a { background: rgba(255,77,109,0.07); border-color: rgba(255,77,109,0.3); }
  .team-card.team-b { background: rgba(76,201,240,0.07); border-color: rgba(76,201,240,0.3); }
  .team-card.team-a:hover { border-color: var(--a); transform: translateY(-2px); }
  .team-card.team-b:hover { border-color: var(--b); transform: translateY(-2px); }

  .team-title {
    font-family: var(--font-display);
    font-size: 32px;
    margin-bottom: 4px;
  }
  .team-title.a { color: var(--a); }
  .team-title.b { color: var(--b); }

  .team-slots {
    margin: 14px 0;
    display: flex;
    flex-direction: column;
    gap: 8px;
    min-height: 100px;
  }

  .player-slot {
    display: flex;
    align-items: center;
    gap: 10px;
    background: var(--surface2);
    border-radius: 8px;
    padding: 10px 14px;
    font-size: 14px;
    font-weight: 600;
  }

  .player-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    flex-shrink: 0;
  }

  .empty-slot {
    border: 1.5px dashed var(--border);
    background: transparent;
    color: var(--muted);
    font-weight: 400;
    font-size: 13px;
    justify-content: center;
  }

  .you-badge {
    font-size: 10px;
    background: var(--surface);
    border-radius: 4px;
    padding: 2px 6px;
    color: var(--muted);
    margin-left: auto;
  }

  /* Sidebar chat */
  .lobby-sidebar {
    display: flex;
    flex-direction: column;
    gap: 16px;
    padding-left: 20px;
  }

  .chat-box {
    flex: 1;
    display: flex;
    flex-direction: column;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    overflow: hidden;
  }

  .chat-header {
    padding: 14px 16px;
    font-weight: 700;
    font-size: 13px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--muted);
    border-bottom: 1px solid var(--border);
  }

  .chat-messages {
    flex: 1;
    overflow-y: auto;
    padding: 12px;
    display: flex;
    flex-direction: column;
    gap: 6px;
    max-height: 280px;
    min-height: 200px;
    scrollbar-width: thin;
    scrollbar-color: var(--border) transparent;
  }

  .chat-msg {
    font-size: 13px;
    line-height: 1.4;
  }

  .chat-msg.system { color: var(--muted); font-style: italic; }

  .chat-msg .sender {
    font-weight: 700;
    margin-right: 4px;
  }

  .chat-input-row {
    display: flex;
    gap: 8px;
    padding: 10px 12px;
    border-top: 1px solid var(--border);
  }

  .chat-input-row input {
    flex: 1;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: 8px 12px;
    color: var(--text);
    font-family: var(--font-body);
    font-size: 13px;
    outline: none;
  }

  .chat-send {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 6px;
    color: var(--text);
    padding: 8px 12px;
    cursor: pointer;
    font-size: 14px;
    transition: background 0.15s;
  }
  .chat-send:hover { background: var(--border); }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     GAME SCREEN
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  #gameScreen {
    justify-content: flex-start;
    align-items: stretch;
    padding: 0;
    width: 100%;
  }

  .game-layout {
    display: grid;
    grid-template-rows: 80px 1fr 200px;
    width: 100%;
    height: 100vh;
    max-width: 1100px;
    margin: 0 auto;
    padding: 20px;
    gap: 16px;
  }

  /* Scorebar */
  .scorebar {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    align-items: center;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 0 24px;
  }

  .score-team {
    display: flex;
    align-items: center;
    gap: 14px;
  }
  .score-team.right { flex-direction: row-reverse; }

  .score-name { font-family: var(--font-display); font-size: 22px; }
  .score-name.a { color: var(--a); }
  .score-name.b { color: var(--b); }

  .score-pts {
    font-family: var(--font-display);
    font-size: 40px;
    line-height: 1;
  }
  .score-pts.a { color: var(--a); }
  .score-pts.b { color: var(--b); }

  .score-center {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
  }

  .timer-ring {
    position: relative;
    width: 56px;
    height: 56px;
  }

  .timer-ring svg {
    transform: rotate(-90deg);
    width: 56px;
    height: 56px;
  }

  .timer-ring .track { fill: none; stroke: var(--surface2); stroke-width: 4; }
  .timer-ring .fill {
    fill: none;
    stroke: var(--green);
    stroke-width: 4;
    stroke-linecap: round;
    stroke-dasharray: 138;
    stroke-dashoffset: 0;
    transition: stroke-dashoffset 1s linear, stroke 0.5s;
  }

  .timer-num {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: var(--font-display);
    font-size: 18px;
    color: var(--text);
  }

  .q-counter { font-size: 11px; color: var(--muted); letter-spacing: 0.1em; }

  /* Question area */
  .question-area {
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .q-meta {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .q-category {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: 4px 12px;
    font-size: 12px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--muted);
  }

  .q-text {
    font-family: var(--font-display);
    font-size: clamp(24px, 4vw, 38px);
    line-height: 1.2;
    color: var(--text);
  }

  .options-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    flex: 1;
  }

  .option-btn {
    background: var(--surface);
    border: 2px solid var(--border);
    border-radius: 12px;
    padding: 16px 20px;
    color: var(--text);
    font-family: var(--font-body);
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    text-align: left;
    display: flex;
    align-items: center;
    gap: 14px;
  }

  .option-btn:hover:not(:disabled) {
    background: var(--surface2);
    border-color: var(--a);
    transform: translateX(4px);
  }

  .option-btn:disabled { cursor: not-allowed; }

  .option-btn .opt-letter {
    width: 32px;
    height: 32px;
    border-radius: 8px;
    background: var(--surface2);
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: var(--font-display);
    font-size: 18px;
    flex-shrink: 0;
    transition: background 0.2s;
  }

  .option-btn.selected { border-color: var(--a); background: rgba(255,77,109,0.1); }
  .option-btn.selected .opt-letter { background: var(--a); color: #fff; }
  .option-btn.correct { border-color: var(--green) !important; background: rgba(6,214,160,0.1) !important; }
  .option-btn.correct .opt-letter { background: var(--green) !important; color: #000 !important; }
  .option-btn.wrong { border-color: #555 !important; opacity: 0.5; }

  /* Team answer indicators */
  .team-indicators {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
  }

  .team-indicator {
    border-radius: 10px;
    padding: 14px 18px;
    display: flex;
    align-items: center;
    gap: 12px;
    background: var(--surface);
    border: 1.5px solid var(--border);
    transition: all 0.3s;
  }

  .team-indicator.locked-a { border-color: var(--a); background: rgba(255,77,109,0.08); }
  .team-indicator.locked-b { border-color: var(--b); background: rgba(76,201,240,0.08); }
  .team-indicator.correct { border-color: var(--green) !important; }
  .team-indicator.wrong { border-color: #555; opacity: 0.6; }

  .indicator-dot {
    width: 12px; height: 12px;
    border-radius: 50%;
    flex-shrink: 0;
    transition: background 0.3s;
  }

  .indicator-name { font-weight: 700; font-size: 13px; }
  .indicator-status { font-size: 12px; color: var(--muted); margin-left: auto; }

  .pulse { animation: pulse 1.5s ease-in-out infinite; }
  @keyframes pulse { 0%,100% { opacity:1; } 50% { opacity:0.4; } }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     REVEAL OVERLAY
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  #revealOverlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.75);
    backdrop-filter: blur(4px);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 100;
    padding: 24px;
  }

  #revealOverlay.show { display: flex; }

  .reveal-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 36px 40px;
    max-width: 560px;
    width: 100%;
    text-align: center;
    animation: slideUp 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  @keyframes slideUp {
    from { transform: translateY(40px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }

  .reveal-label {
    font-size: 12px;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 10px;
  }

  .reveal-answer {
    font-family: var(--font-display);
    font-size: 36px;
    color: var(--green);
    margin-bottom: 28px;
    line-height: 1.2;
  }

  .reveal-results {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-bottom: 24px;
  }

  .reveal-team {
    border-radius: 12px;
    padding: 16px;
    border: 2px solid var(--border);
  }

  .reveal-team.correct { border-color: var(--green); background: rgba(6,214,160,0.08); }
  .reveal-team.wrong { border-color: #555; opacity: 0.7; }
  .reveal-team.no-answer { border-color: #555; opacity: 0.5; }

  .reveal-team-name { font-family: var(--font-display); font-size: 22px; margin-bottom: 6px; }
  .reveal-team-answer { font-size: 13px; color: var(--muted); }

  .winner-banner {
    font-family: var(--font-display);
    font-size: 20px;
    color: var(--gold);
    padding: 10px;
    border-radius: 8px;
    background: rgba(255,215,0,0.1);
    margin-bottom: 20px;
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     GAME OVER
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  #finishedScreen {
    text-align: center;
  }

  .trophy { font-size: 80px; margin-bottom: 16px; }
  .final-scores {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin: 28px 0;
    width: 100%;
    max-width: 500px;
  }

  .final-team {
    border-radius: 16px;
    padding: 28px 20px;
    text-align: center;
  }

  .final-team.a { background: rgba(255,77,109,0.1); border: 2px solid var(--a); }
  .final-team.b { background: rgba(76,201,240,0.1); border: 2px solid var(--b); }
  .final-team.winner { transform: scale(1.05); }

  .final-team-name { font-family: var(--font-display); font-size: 28px; }
  .final-team-score { font-family: var(--font-display); font-size: 60px; }
  .final-team.a .final-team-name { color: var(--a); }
  .final-team.b .final-team-name { color: var(--b); }
  .final-team.a .final-team-score { color: var(--a); }
  .final-team.b .final-team-score { color: var(--b); }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     NOTIFICATION
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  #notification {
    position: fixed;
    top: 20px;
    right: 20px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 14px 20px;
    font-size: 14px;
    font-weight: 600;
    z-index: 999;
    transform: translateX(140%);
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    max-width: 300px;
  }
  #notification.show { transform: translateX(0); }
  #notification.error { border-color: var(--a); color: var(--a); }
  #notification.success { border-color: var(--green); color: var(--green); }
  #notification.info { border-color: var(--b); color: var(--b); }

  /* â”€â”€ Misc â”€â”€ */
  .spacer { flex: 1; }
  .row { display: flex; gap: 10px; }
  .row.center { justify-content: center; align-items: center; }

  @media (max-width: 768px) {
    .lobby-layout { grid-template-columns: 1fr; grid-template-rows: auto 1fr auto; }
    .lobby-sidebar { padding-left: 0; }
    .game-layout { grid-template-rows: 70px 1fr 160px; }
    .options-grid { grid-template-columns: 1fr; }
    .final-scores { grid-template-columns: 1fr; }
    .reveal-results { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>
<div id="app">

  <!-- â•â• JOIN SCREEN â•â• -->
  <div id="joinScreen" class="screen active">
    <div class="join-box">
      <div class="logo-area">
        <div class="logo-title">OFFICE<br>SHOWDOWN</div>
        <div class="logo-sub">2 Teams Â· Real-time Quiz Battle</div>
      </div>
      <div class="join-form card">
        <div style="font-size:13px;color:var(--muted);margin-bottom:6px;font-weight:600;letter-spacing:0.05em;">YOUR NAME</div>
        <input class="input" id="nameInput" type="text" placeholder="Enter your name..." maxlength="20" />
        <button class="btn btn-primary" id="joinBtn" style="margin-top:8px;width:100%;font-size:16px;padding:14px;">
          âš¡ Enter the Arena
        </button>
        <div style="font-size:12px;color:var(--muted);margin-top:12px;text-align:center;">No login needed Â· Just pick a name & join a team</div>
      </div>
    </div>
  </div>

  <!-- â•â• LOBBY SCREEN â•â• -->
  <div id="lobbyScreen" class="screen">
    <div class="lobby-layout">

      <div class="lobby-header">
        <div>
          <div style="font-family:var(--font-display);font-size:28px;">TEAM SELECTION</div>
          <div id="myNameBadge" style="font-size:13px;color:var(--muted);margin-top:2px;"></div>
        </div>
        <div class="row" style="gap:10px;">
          <div id="waitingMsg" style="font-size:13px;color:var(--muted);display:flex;align-items:center;gap:6px;">
            <span class="pulse" style="width:8px;height:8px;background:var(--green);border-radius:50%;display:inline-block;"></span>
            Waiting for players...
          </div>
          <button class="btn btn-green" id="startBtn" style="display:none;">
            â–¶ Start Game
          </button>
        </div>
      </div>

      <div class="teams-area">
        <!-- Team A -->
        <div class="team-card team-a">
          <div class="team-title a">TEAM ALPHA</div>
          <div style="font-size:12px;color:var(--muted);">2â€“3 players</div>
          <div class="team-slots" id="teamASlots"></div>
          <button class="btn btn-a" id="joinTeamA" style="width:100%;">Join Team Alpha</button>
        </div>

        <!-- Team B -->
        <div class="team-card team-b">
          <div class="team-title b">TEAM BETA</div>
          <div style="font-size:12px;color:var(--muted);">2â€“3 players</div>
          <div class="team-slots" id="teamBSlots"></div>
          <button class="btn btn-b" id="joinTeamB" style="width:100%;">Join Team Beta</button>
        </div>

        <!-- Players not in a team -->
        <div class="card" style="grid-column:1/-1;">
          <div style="font-size:12px;letter-spacing:0.1em;text-transform:uppercase;color:var(--muted);margin-bottom:10px;font-weight:700;">Unassigned Players</div>
          <div id="unassignedPlayers" style="display:flex;gap:8px;flex-wrap:wrap;min-height:32px;"></div>
        </div>
      </div>

      <div class="lobby-sidebar">
        <div class="chat-box">
          <div class="chat-header">ğŸ’¬ Team Chat</div>
          <div class="chat-messages" id="chatMessages"></div>
          <div class="chat-input-row">
            <input type="text" id="chatInput" placeholder="Say something..." maxlength="200" />
            <button class="chat-send" id="chatSend">â†‘</button>
          </div>
        </div>

        <div class="card" style="font-size:13px;">
          <div style="font-weight:700;margin-bottom:10px;font-size:12px;letter-spacing:0.1em;text-transform:uppercase;color:var(--muted);">How to Play</div>
          <div style="color:var(--muted);line-height:1.7;">
            1. Pick a team (2â€“3 players each)<br>
            2. Admin starts the game<br>
            3. First player to answer locks in their team's answer<br>
            4. 30 seconds per question<br>
            5. 10 pts for each correct answer
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- â•â• GAME SCREEN â•â• -->
  <div id="gameScreen" class="screen">
    <div class="game-layout">

      <!-- Scorebar -->
      <div class="scorebar">
        <div class="score-team">
          <div>
            <div class="score-name a">TEAM ALPHA</div>
            <div style="font-size:12px;color:var(--muted);" id="teamAPlayers"></div>
          </div>
          <div class="score-pts a" id="scoreA">0</div>
        </div>
        <div class="score-center">
          <div class="timer-ring" id="timerRing">
            <svg viewBox="0 0 56 56">
              <circle class="track" cx="28" cy="28" r="22"/>
              <circle class="fill" cx="28" cy="28" r="22" id="timerArc"/>
            </svg>
            <div class="timer-num" id="timerNum">30</div>
          </div>
          <div class="q-counter" id="qCounter">Q 1 / 15</div>
        </div>
        <div class="score-team right">
          <div style="text-align:right;">
            <div class="score-name b">TEAM BETA</div>
            <div style="font-size:12px;color:var(--muted);text-align:right;" id="teamBPlayers"></div>
          </div>
          <div class="score-pts b" id="scoreB">0</div>
        </div>
      </div>

      <!-- Question -->
      <div class="question-area">
        <div class="q-meta">
          <div class="q-category" id="qCategory">General</div>
        </div>
        <div class="q-text" id="qText">Loading question...</div>
        <div class="options-grid" id="optionsGrid"></div>
      </div>

      <!-- Team indicators -->
      <div class="team-indicators">
        <div class="team-indicator" id="indicatorA">
          <div class="indicator-dot" style="background:var(--a);"></div>
          <div>
            <div class="indicator-name" style="color:var(--a);">TEAM ALPHA</div>
            <div class="indicator-status" id="statusA">Thinking...</div>
          </div>
        </div>
        <div class="team-indicator" id="indicatorB">
          <div class="indicator-dot" style="background:var(--b);"></div>
          <div>
            <div class="indicator-name" style="color:var(--b);">TEAM BETA</div>
            <div class="indicator-status" id="statusB">Thinking...</div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- â•â• FINISHED SCREEN â•â• -->
  <div id="finishedScreen" class="screen">
    <div class="trophy" id="trophyEmoji">ğŸ†</div>
    <div style="font-family:var(--font-display);font-size:48px;margin-bottom:4px;" id="winnerTitle">WINNER!</div>
    <div style="color:var(--muted);font-size:15px;" id="winnerSub">Final scores:</div>
    <div class="final-scores" id="finalScores"></div>
    <div class="row center" style="gap:12px;">
      <button class="btn btn-ghost" id="resetBtn">â†© Play Again</button>
    </div>
  </div>

</div><!-- /#app -->

<!-- â•â• REVEAL OVERLAY â•â• -->
<div id="revealOverlay">
  <div class="reveal-card">
    <div class="reveal-label">Correct Answer</div>
    <div class="reveal-answer" id="revealAnswer">â€”</div>
    <div class="winner-banner" id="revealWinner" style="display:none;"></div>
    <div class="reveal-results" id="revealResults"></div>
    <button class="btn btn-primary" id="nextBtn" style="display:none;width:100%;font-size:15px;">Next Question â†’</button>
    <div id="autoNextMsg" style="font-size:13px;color:var(--muted);margin-top:8px;"></div>
  </div>
</div>

<!-- â•â• NOTIFICATION â•â• -->
<div id="notification"></div>

<script>
// â”€â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let socket;
let myId = null;
let myName = '';
let isAdmin = false;
let myTeam = null;
let gamePhase = 'lobby';
let selectedAnswer = null;
let hasAnswered = false;
let currentTotal = 15;
const TIMER_MAX = 30;
const CIRCUMFERENCE = 2 * Math.PI * 22; // ~138.2

// â”€â”€â”€ Socket Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function initSocket() {
  socket = io();

  socket.on('connect', () => {
    // Stay on join screen until player enters their name
    showScreen('joinScreen');
  });

  socket.on('disconnect', () => {
    myId = null;
    myTeam = null;
    showScreen('joinScreen');
    notify('Disconnected. Please refresh.', 'error');
  });

  socket.on('joined', ({ id, isAdmin: admin, name }) => {
    myId = id;
    isAdmin = admin;
    myName = name;
    socket.emit('requestState');  // Request state AFTER we have an identity
    showScreen('lobbyScreen');
    document.getElementById('myNameBadge').textContent = `Logged in as: ${name}${admin ? ' Â· Admin âš¡' : ''}`;
  });

  socket.on('stateUpdate', (state) => {
    gamePhase = state.phase;
    renderLobby(state);
    renderGameScores(state);
    updateTeamIndicators(state);

    // âš ï¸ Only navigate away from join screen AFTER the player has actually joined
    if (!myId) return;

    if (state.phase === 'lobby' || state.phase === 'team-select') {
      showScreen('lobbyScreen');
    } else if (state.phase === 'question' || state.phase === 'reveal') {
      showScreen('gameScreen');
    } else if (state.phase === 'finished') {
      showScreen('finishedScreen');
    }

    document.getElementById('startBtn').style.display = (isAdmin && state.phase === 'lobby') ? 'block' : 'none';
  });

  socket.on('newQuestion', (data) => {
    hasAnswered = false;
    selectedAnswer = null;
    document.getElementById('revealOverlay').classList.remove('show');
    showScreen('gameScreen');
    renderQuestion(data);
    updateTimer(TIMER_MAX, TIMER_MAX);
    qCounter(data.index + 1, data.total);
    currentTotal = data.total;
  });

  socket.on('timerTick', (val) => {
    updateTimer(val, TIMER_MAX);
  });

  socket.on('revealResult', (data) => {
    showReveal(data);
    markOptions(data.correctIndex);
    updateIndicatorsResult(data);
  });

  socket.on('gameOver', (data) => {
    showScreen('finishedScreen');
    showGameOver(data);
  });

  socket.on('gameReset', () => {
    document.getElementById('revealOverlay').classList.remove('show');
    hasAnswered = false;
    selectedAnswer = null;
    myTeam = null;
    // Only go to lobby if the player has already joined
    if (myId) showScreen('lobbyScreen');
  });

  socket.on('chatMessage', (msg) => {
    appendChat(msg);
  });

  socket.on('error', ({ message }) => {
    notify(message, 'error');
  });
}

// â”€â”€â”€ Render Lobby â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderLobby(state) {
  // Update my team
  const me = state.players.find(p => p.id === myId);
  if (me) { myTeam = me.team; isAdmin = me.isAdmin; }

  renderTeamSlots('A', state);
  renderTeamSlots('B', state);

  // Unassigned
  const unassigned = state.players.filter(p => !p.team);
  const el = document.getElementById('unassignedPlayers');
  if (unassigned.length === 0) {
    el.innerHTML = '<span style="font-size:13px;color:var(--muted);">All players assigned!</span>';
  } else {
    el.innerHTML = unassigned.map(p => `
      <div class="player-slot" style="background:var(--surface2);min-width:0;width:auto;">
        <div class="player-dot" style="background:var(--muted);"></div>
        ${p.name}${p.id === myId ? '<span class="you-badge">YOU</span>' : ''}
      </div>
    `).join('');
  }

  // Start btn
  const canStart = isAdmin && state.phase === 'lobby';
  document.getElementById('startBtn').style.display = canStart ? 'inline-flex' : 'none';
}

function renderTeamSlots(team, state) {
  const MAX = 3;
  const teamId = team;
  const color = team === 'A' ? 'var(--a)' : 'var(--b)';
  const players = state.players.filter(p => p.team === teamId);
  const slotsEl = document.getElementById(`team${team}Slots`);
  let html = '';
  players.forEach(p => {
    html += `
      <div class="player-slot">
        <div class="player-dot" style="background:${color};"></div>
        <span>${p.name}</span>
        ${p.id === myId ? '<span class="you-badge">YOU</span>' : ''}
        ${p.isAdmin ? '<span class="you-badge">ADMIN</span>' : ''}
      </div>
    `;
  });
  for (let i = players.length; i < MAX; i++) {
    html += `<div class="player-slot empty-slot">open slot</div>`;
  }
  slotsEl.innerHTML = html;

  const full = players.length >= MAX;
  const btn = document.getElementById(`joinTeam${team}`);
  btn.disabled = full;
  if (myTeam === teamId) {
    btn.textContent = `âœ“ You're here`;
    btn.disabled = true;
  } else {
    btn.textContent = full ? 'Team Full' : `Join Team ${team === 'A' ? 'Alpha' : 'Beta'}`;
  }
}

function renderGameScores(state) {
  document.getElementById('scoreA').textContent = state.teams.A.score;
  document.getElementById('scoreB').textContent = state.teams.B.score;

  const playersA = state.players.filter(p => p.team === 'A').map(p => p.name).join(', ');
  const playersB = state.players.filter(p => p.team === 'B').map(p => p.name).join(', ');
  document.getElementById('teamAPlayers').textContent = playersA;
  document.getElementById('teamBPlayers').textContent = playersB;
}

// â”€â”€â”€ Render Question â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderQuestion(data) {
  document.getElementById('qCategory').textContent = data.category;
  document.getElementById('qText').textContent = data.q;

  const letters = ['A', 'B', 'C', 'D'];
  const grid = document.getElementById('optionsGrid');
  grid.innerHTML = data.options.map((opt, i) => `
    <button class="option-btn" data-index="${i}" onclick="selectAnswer(${i})">
      <div class="opt-letter">${letters[i]}</div>
      <span>${opt}</span>
    </button>
  `).join('');

  resetIndicators();
}

function selectAnswer(index) {
  if (hasAnswered || gamePhase !== 'question') return;
  hasAnswered = true;
  selectedAnswer = index;

  document.querySelectorAll('.option-btn').forEach(btn => {
    btn.classList.remove('selected');
    if (parseInt(btn.dataset.index) === index) btn.classList.add('selected');
    btn.disabled = true;
  });

  socket.emit('submitAnswer', { answerIndex: index });
  notify('Answer locked in! âš¡', 'success');
}

function markOptions(correctIndex) {
  document.querySelectorAll('.option-btn').forEach(btn => {
    const i = parseInt(btn.dataset.index);
    btn.disabled = true;
    btn.classList.remove('selected');
    if (i === correctIndex) btn.classList.add('correct');
    else btn.classList.add('wrong');
  });
}

// â”€â”€â”€ Team Indicators â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function resetIndicators() {
  ['A','B'].forEach(t => {
    const ind = document.getElementById(`indicator${t}`);
    ind.className = 'team-indicator';
    document.getElementById(`status${t}`).textContent = 'Thinking...';
    document.getElementById(`status${t}`).className = 'indicator-status pulse';
  });
}

function updateTeamIndicators(state) {
  if (state.phase !== 'question') return;
  ['A','B'].forEach(t => {
    const ta = state.teamAnswers?.[t];
    const ind = document.getElementById(`indicator${t}`);
    const status = document.getElementById(`status${t}`);
    if (ta?.locked) {
      ind.className = `team-indicator locked-${t.toLowerCase()}`;
      status.textContent = 'Locked in!';
      status.className = 'indicator-status';
    } else {
      ind.className = 'team-indicator';
      status.textContent = 'Thinking...';
      status.className = 'indicator-status pulse';
    }
  });
}

function updateIndicatorsResult(data) {
  ['A','B'].forEach(t => {
    const ind = document.getElementById(`indicator${t}`);
    const ta = data.teamAnswers?.[t];
    if (!ta) {
      ind.classList.add('no-answer');
      return;
    }
    if (ta.answer === data.correctIndex) ind.classList.add('correct');
    else ind.classList.add('wrong');
  });
}

// â”€â”€â”€ Timer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updateTimer(val, max) {
  document.getElementById('timerNum').textContent = val;
  const arc = document.getElementById('timerArc');
  const pct = val / max;
  arc.style.strokeDashoffset = CIRCUMFERENCE * (1 - pct);
  if (pct <= 0.3) arc.style.stroke = 'var(--a)';
  else if (pct <= 0.6) arc.style.stroke = 'var(--gold)';
  else arc.style.stroke = 'var(--green)';
}

function qCounter(cur, total) {
  document.getElementById('qCounter').textContent = `Q ${cur} / ${total}`;
}

// â”€â”€â”€ Reveal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showReveal(data) {
  document.getElementById('revealAnswer').textContent = data.correctAnswer;

  const wb = document.getElementById('revealWinner');
  if (data.winner) {
    const wName = data.winner === 'A' ? 'Team Alpha' : 'Team Beta';
    wb.textContent = `ğŸ‰ +10 pts â€” ${wName} got it right!`;
    wb.style.display = 'block';
  } else {
    wb.style.display = 'none';
  }

  const rr = document.getElementById('revealResults');
  rr.innerHTML = ['A','B'].map(t => {
    const ta = data.teamAnswers?.[t];
    const correct = ta && ta.answer === data.correctIndex;
    const teamName = t === 'A' ? 'Team Alpha' : 'Team Beta';
    const color = t === 'A' ? 'var(--a)' : 'var(--b)';
    let cls = 'reveal-team';
    if (!ta) cls += ' no-answer';
    else if (correct) cls += ' correct';
    else cls += ' wrong';

    return `
      <div class="${cls}">
        <div class="reveal-team-name" style="color:${color}">${teamName}</div>
        <div class="reveal-team-answer">
          ${!ta ? 'No answer' : correct ? 'âœ… Correct!' : 'âŒ ' + (ta.lockedBy ? `${ta.lockedBy} answered wrong` : 'Wrong')}
        </div>
      </div>
    `;
  }).join('');

  const nextBtn = document.getElementById('nextBtn');
  const autoMsg = document.getElementById('autoNextMsg');
  if (isAdmin) {
    nextBtn.style.display = 'block';
    autoMsg.textContent = '';
  } else {
    nextBtn.style.display = 'none';
    autoMsg.textContent = 'Waiting for admin to continue...';
  }

  document.getElementById('revealOverlay').classList.add('show');
}

// â”€â”€â”€ Game Over â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showGameOver(data) {
  document.getElementById('revealOverlay').classList.remove('show');
  const isDraw = data.winner === 'draw';
  const trophy = isDraw ? 'ğŸ¤' : 'ğŸ†';
  document.getElementById('trophyEmoji').textContent = trophy;

  let title, sub;
  if (isDraw) {
    title = "IT'S A DRAW!";
    sub = 'Both teams are equally legendary.';
  } else {
    const wName = data.winner === 'A' ? 'TEAM ALPHA' : 'TEAM BETA';
    title = `${wName} WINS!`;
    sub = 'Congratulations to the champions!';
  }
  document.getElementById('winnerTitle').textContent = title;
  document.getElementById('winnerSub').textContent = sub;

  document.getElementById('finalScores').innerHTML = `
    <div class="final-team a ${data.winner === 'A' ? 'winner' : ''}">
      <div class="final-team-name">ALPHA</div>
      <div class="final-team-score">${data.scores.A}</div>
      ${data.winner === 'A' ? '<div style="color:var(--gold);margin-top:6px;">ğŸ‘‘ WINNER</div>' : ''}
    </div>
    <div class="final-team b ${data.winner === 'B' ? 'winner' : ''}">
      <div class="final-team-name">BETA</div>
      <div class="final-team-score">${data.scores.B}</div>
      ${data.winner === 'B' ? '<div style="color:var(--gold);margin-top:6px;">ğŸ‘‘ WINNER</div>' : ''}
    </div>
  `;
  document.getElementById('resetBtn').style.display = isAdmin ? 'block' : 'none';
}

// â”€â”€â”€ Chat â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function appendChat(msg) {
  const el = document.getElementById('chatMessages');
  const div = document.createElement('div');
  div.className = 'chat-msg' + (msg.system ? ' system' : '');
  if (msg.system) {
    div.textContent = msg.text;
  } else {
    div.innerHTML = `<span class="sender" style="color:${msg.teamColor}">${msg.player}:</span> ${escapeHtml(msg.text)}`;
  }
  el.appendChild(div);
  el.scrollTop = el.scrollHeight;
}

function escapeHtml(t) {
  return t.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

function sendChat() {
  const input = document.getElementById('chatInput');
  const text = input.value.trim();
  if (!text) return;
  socket.emit('chatMessage', { text });
  input.value = '';
}

// â”€â”€â”€ Notifications â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let notifTimer;
function notify(msg, type = 'info') {
  const el = document.getElementById('notification');
  el.textContent = msg;
  el.className = `show ${type}`;
  clearTimeout(notifTimer);
  notifTimer = setTimeout(() => el.classList.remove('show'), 3000);
}

// â”€â”€â”€ Screen Management â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

// â”€â”€â”€ Event Listeners â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.getElementById('joinBtn').addEventListener('click', () => {
  const name = document.getElementById('nameInput').value.trim();
  if (!name) { notify('Please enter your name!', 'error'); return; }
  socket.emit('joinGame', { name });
});

document.getElementById('nameInput').addEventListener('keydown', e => {
  if (e.key === 'Enter') document.getElementById('joinBtn').click();
});

document.getElementById('joinTeamA').addEventListener('click', () => {
  socket.emit('chooseTeam', { team: 'A' });
});

document.getElementById('joinTeamB').addEventListener('click', () => {
  socket.emit('chooseTeam', { team: 'B' });
});

document.getElementById('startBtn').addEventListener('click', () => {
  socket.emit('startGame');
});

document.getElementById('nextBtn').addEventListener('click', () => {
  document.getElementById('revealOverlay').classList.remove('show');
  socket.emit('nextQuestion');
});

document.getElementById('resetBtn').addEventListener('click', () => {
  socket.emit('resetGame');
});

document.getElementById('chatSend').addEventListener('click', sendChat);
document.getElementById('chatInput').addEventListener('keydown', e => {
  if (e.key === 'Enter') sendChat();
});

// â”€â”€â”€ Boot â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
initSocket();
</script>
</body>
</html>
